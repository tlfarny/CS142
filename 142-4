#include <iostream>
#include <iomanip>
#include <ctime>

using namespace std;

const int SLOT_VALUES[9] = {100, 500, 1000, 0, 10000, 0, 1000, 500, 100};

void incPosition(double &slot){
  slot += 0.5;
}

void decPosition(double &slot){
  slot -= 0.5;
}

int coinDrop(bool displayPath, int slot){
  //13 including the slot and starting point
  int path[13];
  double currentSlot = slot;
  path[0] = slot;
  if (displayPath == true) {
    cout<<"Path: ["<<currentSlot<<" ";
  }
  for (int i = 1; i < 13; i++) {
    if (currentSlot == 0) {
      incPosition(currentSlot);
    } else if (currentSlot == 8) {
      decPosition(currentSlot);
    } else {
      int random = rand() % 2;
      if (random == 0) {
        decPosition(currentSlot);
      } else {
        incPosition(currentSlot);
      }
    }
    if (displayPath == true) {
      cout<<currentSlot<<" ";
    }
  }
  if (displayPath == true) {
    cout<<"]"<<endl;
  }
  return SLOT_VALUES[(int)currentSlot];
}

int slotSelector(int &slot){
  cout<<"Please select the slot into which you would like to drop your coin:"<<endl;
  cin>>slot;
  while (slot < 0 || slot > 8) {
    cout<<"Invalid. Please select a slot between 0 and 8."<<endl;
    cin>>slot;
  }
  return slot;
}

int main(int argc, char const *argv[]) {
  srand(time(0));
  int option = 0;
  int slot;
  int score;
  cout<<"::::::::::::::::::::::PLINKO::::::::::::::::::::::"<<endl;
  cout<<"Please select what you would like to do from the following options:"<<endl;
  while (option != 3)
    score = 0;
    cout<<"1 - Drop a single coin into a selected slot."<<endl;
    cout<<"2 - Drop multiple coins into a single selected slot."<<endl;
    cout<<"3 - Quit the program."<<endl;
    cin>>option;
    switch (option) {
      case 1:{
        slotSelector(slot);
        score = coinDrop(true, slot);
        if (score == 0) {
          cout<<"Bummer! You didn't win anything with that coin."<<endl;
        } else {
          cout<<"Congratulations! You won "<<score<<" points playing PLINKO"<<endl;
        }
        cout<<"What would you like to do now?"<<endl;
        break;
      }
      case 2:{
        slotSelector(slot);
        int numberOfCoins;
        cout<<"How many coins would you like to drop into that slot?"<<endl;
        cin>>numberOfCoins;
        for (int i = 0; i < numberOfCoins; i++) {
          score += coinDrop(false, slot);
        }
        double perCoin = score / numberOfCoins;
        cout<<"Congratulations! You won $"<<score<<" with your "<<numberOfCoins<<" coins, averaging $";
        cout<<fixed<<setprecision(2)<<perCoin<<" per coin."<<endl;
        cout<<"What would you like to do now?"<<endl;
        break;
      }
      case 3:{
        cout<<"Thank you for playing PLINKO!"<<endl;
        break;
      }
      default:
        cout<<"Invalid. Please make your selection of 1, 2, or 3."<<endl;
        break;
    }
  }
  return 0;
}
